# ðŸ“¹ ì‹¤ì‹œê°„ BBox ê²€ì¶œ í™”ë©´ ê°€ì´ë“œ

## âœ… "ì‹¤ì‹œê°„ ê²€ì¶œ" ì‹¤í–‰ ì‹œ í™”ë©´ êµ¬ì„±

ë„¤, ë§žìŠµë‹ˆë‹¤! **ì‹¤ì‹œê°„ ê²€ì¶œì„ ì‹¤í–‰í•˜ë©´ ì¹´ë©”ë¼ í™”ë©´ì— ê²€ì¶œí•œ BBox(ë°”ìš´ë”© ë°•ìŠ¤)ë¥¼ ë§ì”Œì›Œì„œ** ë³´ì—¬ì¤ë‹ˆë‹¤.

---

## ðŸŽ¨ í™”ë©´ í‘œì‹œ ìš”ì†Œ

### 1. **ì‚¬ëžŒ ê²€ì¶œ BBox (íŒŒëž€ìƒ‰ ë°•ìŠ¤)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Person 0.95    â”‚  â† í´ëž˜ìŠ¤ëª… + ì‹ ë¢°ë„
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      íŒŒëž€ìƒ‰ ë°•ìŠ¤
```

**í‘œì‹œ ë‚´ìš©:**
- **ë°•ìŠ¤ ìƒ‰ìƒ**: íŒŒëž€ìƒ‰ (`cv2.rectangle`)
- **í…ìŠ¤íŠ¸**: "Person 0.95" (ì‹ ë¢°ë„ í‘œì‹œ)
- **ìœ„ì¹˜**: ê²€ì¶œëœ ì‚¬ëžŒì˜ ë°”ìš´ë”© ë°•ìŠ¤

**ì½”ë“œ ìœ„ì¹˜:** `realtime_detector.py` - `draw_rois_and_detections()` ë©”ì„œë“œ

```python
# BBox ê·¸ë¦¬ê¸° (íŒŒëž€ìƒ‰)
cv2.rectangle(frame, (x1, y1), (x2, y2), (255, 0, 0), 2)

# ì‹ ë¢°ë„ í‘œì‹œ
cv2.putText(frame, f'Person {conf:.2f}', 
            (x1, y1-10), cv2.FONT_HERSHEY_SIMPLEX, 
            0.5, (255, 0, 0), 2)
```

---

### 2. **ROI ì˜ì—­ í‘œì‹œ (Polygon)**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ROI1                       â”‚  â† ROI ID
â”‚  ìƒíƒœ: ê²€ì¶œ (5ì´ˆ)            â”‚  â† ê²€ì¶œ ìƒíƒœ + ì§€ì† ì‹œê°„
â”‚  ì „ì†¡: present              â”‚  â† ë§ˆì§€ë§‰ API ì „ì†¡ ìƒíƒœ
â”‚                             â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚    â”‚ Person   â”‚  â† BBox     â”‚
â”‚    â”‚  0.95    â”‚             â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     ë…¹ìƒ‰ í…Œë‘ë¦¬ (ì‚¬ëžŒ ê²€ì¶œë¨)
```

**ROI ìƒ‰ìƒ ê·œì¹™:**
- **ë…¹ìƒ‰**: ì‚¬ëžŒì´ ê²€ì¶œë¨ (person detected)
- **ë¹¨ê°„ìƒ‰**: ì‚¬ëžŒì´ ì—†ìŒ (no person)

**í‘œì‹œ ì •ë³´:**
- ROI ID (ì˜ˆ: "ROI1", "ROI2")
- ê²€ì¶œ ìƒíƒœ (ê²€ì¶œ/ë¯¸ê²€ì¶œ)
- ì§€ì† ì‹œê°„ (ì´ˆ ë‹¨ìœ„)
- ë§ˆì§€ë§‰ API ì „ì†¡ ìƒíƒœ (present/absent/None)

---

### 3. **ì „ì²´ í™”ë©´ êµ¬ì„± ì˜ˆì‹œ**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ì¹´ë©”ë¼ í™”ë©´ (1280x720)                   â”‚
â”‚                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ROI1 (ë…¹ìƒ‰)              â”‚      â”‚ ROI2 (ë¹¨ê°„ìƒ‰)     â”‚   â”‚
â”‚  â”‚ ìƒíƒœ: ê²€ì¶œ (5ì´ˆ)          â”‚      â”‚ ìƒíƒœ: ë¯¸ê²€ì¶œ (1ì´ˆ)â”‚   â”‚
â”‚  â”‚ ì „ì†¡: present            â”‚      â”‚ ì „ì†¡: None       â”‚   â”‚
â”‚  â”‚                         â”‚      â”‚                  â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚      â”‚                  â”‚   â”‚
â”‚  â”‚   â”‚Person   â”‚           â”‚      â”‚                  â”‚   â”‚
â”‚  â”‚   â”‚  0.95   â”‚           â”‚      â”‚                  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚      â”‚                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                           â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚                    â”‚ ROI3 (ë…¹ìƒ‰)      â”‚                   â”‚
â”‚                    â”‚ ìƒíƒœ: ê²€ì¶œ (3ì´ˆ)  â”‚                   â”‚
â”‚                    â”‚ ì „ì†¡: None       â”‚                   â”‚
â”‚                    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚                   â”‚
â”‚                    â”‚   â”‚Person   â”‚   â”‚                   â”‚
â”‚                    â”‚   â”‚  0.92   â”‚   â”‚                   â”‚
â”‚                    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚                   â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚                                                           â”‚
â”‚  FPS: 30.0  (í™”ë©´ í‘œì‹œ)                                    â”‚
â”‚  Detection: 1.0 FPS  (YOLO ì¶”ë¡  ê°„ê²©)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í†µê³„ ì •ë³´:
- ROI1: ê²€ì¶œ ì¤‘ (5ì´ˆ) â†’ 5ì´ˆ ì§€ì† ì‹œ 'present' API ì „ì†¡
- ROI2: ë¯¸ê²€ì¶œ (1ì´ˆ)
- ROI3: ê²€ì¶œ ì¤‘ (3ì´ˆ) â†’ ì¶”ê°€ 2ì´ˆ ì§€ì† ì‹œ 'present' API ì „ì†¡
```

---

## ðŸ“Š Streamlit UI êµ¬ì„±

### **ì‹¤ì‹œê°„ ê²€ì¶œ íƒ­**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ðŸ“¹ ì‹¤ì‹œê°„ ê²€ì¶œ                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  [ì‹œìž‘] ë²„íŠ¼  (ë˜ëŠ” [ì¤‘ì§€] ë²„íŠ¼)                          â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                   â”‚  â”‚
â”‚  â”‚         ì¹´ë©”ë¼ í™”ë©´ (BBox + ROI í‘œì‹œ)              â”‚  â”‚
â”‚  â”‚                                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  FPS: 30.0                                              â”‚
â”‚                                                         â”‚
â”‚  ðŸ“Š ROIë³„ ìƒíƒœ                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ROI1: âœ… ê²€ì¶œ (5ì´ˆ) - ì¹´ìš´íŠ¸: 47                  â”‚   â”‚
â”‚  â”‚ ROI2: âŒ ë¯¸ê²€ì¶œ (1ì´ˆ) - ì¹´ìš´íŠ¸: 0                 â”‚   â”‚
â”‚  â”‚ ROI3: âœ… ê²€ì¶œ (3ì´ˆ) - ì¹´ìš´íŠ¸: 28                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ”§ BBox í‘œì‹œ ì½”ë“œ ë¶„ì„

### `realtime_detector.py` - `draw_rois_and_detections()` ë©”ì„œë“œ

```python
def draw_rois_and_detections(self, frame):
    """
    í”„ë ˆìž„ì— ROIì™€ ê²€ì¶œ ê²°ê³¼ë¥¼ ê·¸ë¦½ë‹ˆë‹¤
    
    Args:
        frame: OpenCV í”„ë ˆìž„ (NumPy array)
    
    Returns:
        frame: BBoxì™€ ROIê°€ ê·¸ë ¤ì§„ í”„ë ˆìž„
    """
    frame_copy = frame.copy()
    
    # 1ï¸âƒ£ ROI ì˜ì—­ ê·¸ë¦¬ê¸°
    for roi in self.roi_regions:
        roi_id = roi['id']
        points = np.array(roi['points'], dtype=np.int32)
        
        # ROI ìƒíƒœì— ë”°ë¼ ìƒ‰ìƒ ê²°ì •
        roi_state = self.roi_states.get(roi_id, {})
        person_detected = roi_state.get('person_detected', False)
        
        if person_detected:
            color = (0, 255, 0)  # ë…¹ìƒ‰ (ì‚¬ëžŒ ê²€ì¶œ)
        else:
            color = (0, 0, 255)  # ë¹¨ê°„ìƒ‰ (ì‚¬ëžŒ ì—†ìŒ)
        
        # Polygon ROI ê·¸ë¦¬ê¸°
        cv2.polylines(frame_copy, [points], True, color, 2)
        
        # ROI ì •ë³´ í…ìŠ¤íŠ¸
        cv2.putText(frame_copy, f"ROI: {roi_id}", 
                    (points[0][0], points[0][1] - 10),
                    cv2.FONT_HERSHEY_SIMPLEX, 0.6, color, 2)
    
    # 2ï¸âƒ£ ì‚¬ëžŒ ê²€ì¶œ BBox ê·¸ë¦¬ê¸°
    for detection in self.last_detections:
        bbox = detection['bbox']
        conf = detection['confidence']
        
        # BBox ì¢Œí‘œ
        x1, y1, x2, y2 = map(int, bbox)
        
        # íŒŒëž€ìƒ‰ ë°•ìŠ¤ ê·¸ë¦¬ê¸°
        cv2.rectangle(frame_copy, (x1, y1), (x2, y2), (255, 0, 0), 2)
        
        # ì‹ ë¢°ë„ í…ìŠ¤íŠ¸
        label = f'Person {conf:.2f}'
        cv2.putText(frame_copy, label, (x1, y1 - 10),
                    cv2.FONT_HERSHEY_SIMPLEX, 0.5, (255, 0, 0), 2)
    
    return frame_copy
```

---

## âš™ï¸ ì„¤ì • íŒŒë¼ë¯¸í„°

### `config.json` - ê²€ì¶œ ì„¤ì •

```json
{
  "yolo_model": "yolov8n.pt",
  "confidence_threshold": 0.5,
  "detection_interval_seconds": 1.0,
  "frame_width": 1280,
  "frame_height": 720
}
```

**íŒŒë¼ë¯¸í„° ì„¤ëª…:**
- `confidence_threshold`: BBox í‘œì‹œ ìµœì†Œ ì‹ ë¢°ë„ (0.0~1.0)
- `detection_interval_seconds`: YOLO ì¶”ë¡  ê°„ê²© (ì´ˆ)
- `frame_width/height`: ì¹´ë©”ë¼ í•´ìƒë„

---

## ðŸŽ¯ ì‹¤ì‹œê°„ ê²€ì¶œ ë™ìž‘ íë¦„

```
1. ì¹´ë©”ë¼ì—ì„œ í”„ë ˆìž„ ì½ê¸° (30 FPS)
   â†“
2. 1ì´ˆë§ˆë‹¤ YOLO ì¶”ë¡  (1 FPS)
   â†“
3. ì‚¬ëžŒ ê²€ì¶œ â†’ BBox ì •ë³´ ì €ìž¥
   â†“
4. ROI ë‚´ë¶€ ì‚¬ëžŒ í™•ì¸
   â†“
5. í”„ë ˆìž„ì— BBox + ROI ê·¸ë¦¬ê¸°
   â†“
6. Streamlit UIì— í‘œì‹œ (30 FPS)
   â†“
7. ROI ìƒíƒœ ì—…ë°ì´íŠ¸
   â†“
8. API ì´ë²¤íŠ¸ ì „ì†¡ (ì¡°ê±´ ì¶©ì¡± ì‹œ)
```

---

## ðŸ“ˆ ì„±ëŠ¥ íŠ¹ì§•

### í™”ë©´ í‘œì‹œ ì„±ëŠ¥
- **ì¹´ë©”ë¼ í”„ë ˆìž„**: 30 FPS (ë¶€ë“œëŸ¬ìš´ ë¹„ë””ì˜¤)
- **YOLO ì¶”ë¡ **: 1 FPS (ì„¤ì • ê°€ëŠ¥: 0.5~5ì´ˆ)
- **UI ì‘ë‹µì„±**: ì¦‰ê° ë°˜ì‘ (ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œ)

### ë¦¬ì†ŒìŠ¤ ì‚¬ìš©
- **CPU/GPU**: 40-60% ì ˆê° (1ì´ˆ ê°„ê²© ì„¤ì • ì‹œ)
- **ì „ë ¥ ì†Œëª¨**: 8-12W (Jetson Orin Nano)
- **ë©”ëª¨ë¦¬**: ì•½ 500MB (YOLO ëª¨ë¸ í¬í•¨)

---

## ðŸš€ ì‹œìž‘ ë°©ë²•

### 1. íŒ¨í‚¤ì§€ ì„¤ì¹˜

```bash
# x86_64 í™˜ê²½
pip install -r requirements.txt

# Jetson Orin í™˜ê²½
pip install -r requirements_jetson.txt
```

### 2. ì•± ì‹¤í–‰

```bash
streamlit run streamlit_app.py
```

### 3. ì‹¤ì‹œê°„ ê²€ì¶œ ì‹œìž‘

1. ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì—ì„œ ROI íŽ¸ì§‘
2. **ì‹¤ì‹œê°„ ê²€ì¶œ** íƒ­ ì„ íƒ
3. **ì‹œìž‘** ë²„íŠ¼ í´ë¦­
4. **ì¹´ë©”ë¼ í™”ë©´ì—ì„œ BBox í™•ì¸** âœ…

---

## ðŸ” ë¬¸ì œ í•´ê²°

### BBoxê°€ í‘œì‹œë˜ì§€ ì•ŠëŠ” ê²½ìš°

**1. ì‹ ë¢°ë„ ìž„ê³„ê°’ í™•ì¸**
```
ì¢Œì¸¡ ì‚¬ì´ë“œë°” â†’ Confidence Threshold â†’ 0.3ìœ¼ë¡œ ë‚®ì¶¤
```

**2. YOLO ëª¨ë¸ í™•ì¸**
```bash
python3 -c "from ultralytics import YOLO; YOLO('yolov8n.pt')"
```

**3. NumPy ì˜¤ë¥˜ í•´ê²°**
```bash
# FIX_NUMPY_ERROR.md ì°¸ê³ 
pip uninstall -y numpy
pip install "numpy>=1.24.0,<2.0.0"
```

---

## ðŸ“š ê´€ë ¨ ë¬¸ì„œ

- **FIX_NUMPY_ERROR.md** - NumPy ì˜¤ë¥˜ í•´ê²° (ì‹ ê·œ) â­
- **PERFORMANCE_OPTIMIZATION.md** - ì„±ëŠ¥ ìµœì í™”
- **DETECTION_INTERVAL.md** - íƒì§€ ê°„ê²© ì„¤ì •
- **README_STREAMLIT.md** - Streamlit UI ê°€ì´ë“œ

---

## âœ… í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì‹¤ì‹œê°„ ê²€ì¶œì´ ì •ìƒ ìž‘ë™í•˜ëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”:

- [ ] ì¹´ë©”ë¼ í™”ë©´ì´ í‘œì‹œë¨ (30 FPS)
- [ ] **íŒŒëž€ìƒ‰ BBoxê°€ ì‚¬ëžŒ ìœ„ì— í‘œì‹œë¨** âœ…
- [ ] **ROI ì˜ì—­ì´ ë…¹ìƒ‰/ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œë¨** âœ…
- [ ] ì‹ ë¢°ë„ ìˆ˜ì¹˜ê°€ BBox ìœ„ì— í‘œì‹œë¨ (ì˜ˆ: "Person 0.95")
- [ ] ROIë³„ ìƒíƒœ ì •ë³´ê°€ ì—…ë°ì´íŠ¸ë¨
- [ ] FPS ì¹´ìš´í„°ê°€ í‘œì‹œë¨
- [ ] ê²€ì¶œ ê°„ê²©ì´ 1ì´ˆë¡œ ì„¤ì •ë¨

ëª¨ë“  í•­ëª©ì´ ì²´í¬ë˜ë©´ ì •ìƒìž…ë‹ˆë‹¤! ðŸŽ‰
